<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>MarketPulseAI</title>
    <link rel="stylesheet" href="popup.css" />
  </head>
  <body>
    <main>
      <h1>MarketPulseAI</h1>
      <p class="subtitle">Offline swing rankings for the Tehran Stock Exchange.</p>
      <!-- Action buttons for exporting current rankings and importing new Excel data. -->
      <div id="controls">
        <button id="export">Export Excel</button>
        <button id="import">Import Excel</button>
      </div>
      <!-- Rankings table populated by popup.js once data is loaded or imported. -->
      <table id="rankings">
        <thead>
          <tr>
            <th>Symbol</th>
            <th>Probability</th>
            <th>Swing %</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <!-- Hidden file input triggered by the import button to select Excel files. -->
      <input id="import-file" type="file" accept=".xlsx" hidden />
    </main>

    <div id="analysis-modal" class="modal hidden" aria-live="polite">
      <div class="modal-card">
        <h2>Analysis in progress</h2>
        <p id="analysis-status-text">Analysis running...</p>
        <div class="progress-track">
          <div id="analysis-progress-bar" class="progress-bar"></div>
        </div>
      </div>
    </div>

    <script src="../vendor/xlsx.full.min.js"></script>
    <script type="module" src="popup.js"></script>
  </body>
</html>
